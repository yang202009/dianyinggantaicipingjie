# 电影感字幕拼接工具需求文档 (PRD)

| 文档版本 | 修改日期 | 修改人 | 备注 |
| :--- | :--- | :--- | :--- |
| v1.0 | 2026-01-12 | AI Assistant | 初始版本 |

## 1. 项目概述 (Overview)

### 1.1 背景
在社交媒体传播中，用户经常需要分享电影台词截图。传统的做法是手动截取多张图片并使用修图软件拼接，过程繁琐且难以保证对齐和美观。本工具旨在通过自动化的方式，帮助用户快速生成具有“电影感”的台词拼接长图。

### 1.2 产品目标
*   提供一个轻量级、无需后端的网页工具。
*   实现“上传一张底图 + 输入多行文字”即可自动生成长图的核心功能。
*   复现经典的电影截图拼接效果（保留首图主体，后续行重复底部切片）。

## 2. 用户角色 (User Roles)
*   **内容创作者/影迷**：希望快速制作并分享电影台词长图。

## 3. 核心业务流程 (User Flow)
1.  **上传**：用户选择一张本地图片作为底图。
2.  **输入**：用户输入多行对话台词。
3.  **调节**：
    *   调整切片高度，避开画面主体，确保拼接自然。
    *   调整字体大小、位置，确保清晰可读。
4.  **预览与保存**：实时查看拼接效果，满意后一键下载长图。

## 4. 功能需求 (Functional Requirements)

### 4.1 图片处理模块
| ID | 功能名称 | 详细描述 | 优先级 |
| :--- | :--- | :--- | :--- |
| FR-1.1 | 图片上传 | 支持用户上传 JPG、PNG 格式的图片。 | P0 |
| FR-1.2 | 图片读取 | 前端通过 FileReader API 读取图片数据，无需上传至服务器。 | P0 |
| FR-1.3 | 原始尺寸保留 | 处理过程中应尽量保留原图分辨率，避免画质压缩。 | P1 |

### 4.2 字幕编辑模块
| ID | 功能名称 | 详细描述 | 优先级 |
| :--- | :--- | :--- | :--- |
| FR-2.1 | 多行输入 | 提供多行文本输入框（Textarea），每行文本对应生成图片的一层。 | P0 |
| FR-2.2 | 自动分层 | 第一行文本对应完整底图，第二行及后续文本对应底部切片。 | P0 |
| FR-2.3 | 空行处理 | 允许用户输入空行，若为空行则只生成图像切片而不渲染文字（用于留白或节奏控制）。 | P2 |

### 4.3 图像拼接与渲染算法 (核心)
| ID | 功能名称 | 详细描述 | 优先级 |
| :--- | :--- | :--- | :--- |
| FR-3.1 | 首帧渲染 | 长图的顶部必须是完整的原始底图，包含第一行字幕。 | P0 |
| FR-3.2 | 切片截取 | 对于第二行及之后的每一行字幕，程序应从原始底图的**底部**截取指定高度的区域。 | P0 |
| FR-3.3 | 垂直拼接 | 将所有生成的图像块（首帧 + N个切片）按顺序垂直拼接。 | P0 |
| FR-3.4 | 实时渲染 | 任何参数（文字、高度、样式）的变化都应触发 Canvas 的重绘，实现所见即所得。 | P0 |

### 4.4 视觉样式调节
| ID | 功能名称 | 详细描述 | 优先级 |
| :--- | :--- | :--- | :--- |
| FR-4.1 | 切片高度调节 | 用户可拖动滑块调整切片的高度（例如 5% - 50% 的原图高度），用于控制“切割感”和避开主体。 | P0 |
| FR-4.2 | 字体大小 | 调整字幕文字的字号。 | P1 |
| FR-4.3 | 垂直偏移 | 调整文字在切片区域内的垂直位置（上下微调）。 | P1 |
| FR-4.4 | 行间距 | 调整切片之间的垂直间距（默认为0，紧密拼接）。 | P2 |
| FR-4.5 | 文字描边 | 默认提供黑色描边/阴影，确保白色文字在复杂背景下可读。 | P1 |

### 4.5 导出模块
| ID | 功能名称 | 详细描述 | 优先级 |
| :--- | :--- | :--- | :--- |
| FR-5.1 | 图片下载 | 将 Canvas 内容导出为 PNG 图片并触发浏览器下载。 | P0 |

## 5. 非功能需求 (Non-functional Requirements)

### 5.1 性能
*   **响应速度**：图片生成应在 500ms 内完成（基于主流设备性能）。
*   **内存管理**：处理高分辨率图片（如 4K）时，应避免浏览器崩溃。

### 5.2 兼容性
*   **浏览器**：支持 Chrome, Firefox, Safari, Edge 最新版本。
*   **设备**：适配桌面端和移动端布局（响应式设计）。

### 5.3 隐私与安全
*   **本地处理**：所有图片处理均在浏览器端（Client-side）完成，不上传任何用户图片到服务器。

## 6. 界面布局建议 (UI Layout)
建议采用左右分栏或上下分栏布局：
*   **控制面板**：包含上传按钮、文本框、所有滑块调节器。
*   **预览面板**：居中显示生成的 Canvas 长图，下方放置“下载”按钮。

## 7. 技术栈建议
*   **核心逻辑**：HTML5 Canvas API
*   **框架**：原生 JavaScript (Vanilla JS) 或 Vue/React (如果需要扩展更多复杂功能)。
*   **样式**：CSS3 Flexbox/Grid 布局。
